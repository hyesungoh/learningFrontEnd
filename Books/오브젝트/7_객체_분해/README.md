# 객체 분해

문제 해결에 필요한 요소의 수가 단기 기억의 용량을 초과하는 순간 문제 해결 능력은 급격하게 떨어지고 만다.

이런 현상을 인지 과부하(cognitive overload)라고 부른다.

> 임의로 조합된 11자리 정수 8개를 한꺼번에 기억하는 것은 힘들지만 11자리 정수를 전화번호라는 개념적 청크로 묶으면 8명에 대한 전화번호를 기억할 수 있도록 인지능력을 향상시킬 수 있다.

따라서 추상화와 분해는 인간이 세계를 인식하고 반응하기 위해 사용하는 가장 기본적인 사고 도구라고 할 수 있다.

## 프로시저 추상화와 데이터 추상화

현대적인 프로그래밍 언어를 특징 짓는 중요한 두 가지 추상화 메커니즘은 프로시저 추상화(procedure abstraction)와 데이터 추상화(data abstraction)다.

프로시저 추상화는 소프트웨어가 무엇을 해야 하는지를 추상화한다.

데이터 추상화는 소프트웨어가 무엇을 알아야 하는지를 추상화한다.

소프트웨어는 데이터를 이용해 정보를 표현하고 프로시저를 이용해 데이터를 조작한다.

## 프로시저 추상화와 기능 분해

기능은 오랜 시간 동안 시스템을 분해하기 위한 기준으로 사용됐으며,

이 같은 시스템 분해 방식을 **알고리즘 분해 또는 기능 분해**라고 부른다.

<br />

하향식 기능 분해는 논리적이고 체계적인 시스템 개발 절차를 제시한다.

커다란 기능을 좀 더 작은 기능으로 단계적으로 정제해 가는 과정은 구조적이며 체계적인 동시에 이상적인 방법으로까지 보일 것이다.

문제는 우리가 사는 세계는 그렇게 체계적이지도, 이상적이지도 않다는 점이다.

체계적이고 이상적인 방법이 불규칙하고 불완전한 인간과 만나는 지점에서 혼란과 동요가 발생한다.

### 하향식 기능 분해의 문제점

- 시스템은 하나의 메인 함수로 구성돼 있지 않다
- 기능 추가나 요구사항 변경으로 인해 메인 함수를 빈번하게 수정해야 한다
- 비즈니스 로직이 사용자 인터페이스와 강하게 결합된다
- 하향식 분해는 너무 이른 시기에 함수들의 실행 순서를 고정시키기 때문에 유연성과 재사용성이 저하된다
- 데이터 형식이 변경될 경우 파급효과를 예측할 수 없다

하향식 접근법과 기능 분해가 가지는 근본적인 문제점은 변경에 취약한 설계를 낳는다는 것이다.

<br />

하향식 접근법은 하나의 알고리즘을 구현하거나 배치 처리를 구현하기에는 적합하지만 현대적인 상호작용 시스템을 개발하는데는 적합하지 않다

### 언제 하향식 분해가 유용한가?

하향식 분해는 프로젝트 초기에 설계의 본질적인 측면을 무시하고 사용자 인터페이스 같은 비본질적인 측면에 집중하게 만든다.

과도하게 함수에 집중하게 함으로써 소프트웨어의 중요한 다른 측면인 데이터에 대한 영향도를 파악하기 어렵게 만든다.

또한 하향식 분해를 적용한 설계는 근본적으로 재사용하기 어렵다.

## 데이터 추상화와 추상 데이터 타입

개별 인스턴스를 생성할 수 있는 추상 데이터 타입은

전체 직원을 캡슐화하는 모듈보다는 좀 더 개념적으로 사람들의 사고방식에 가깝다

<br />

추상 데이터 타입은 데이터에 대한 관점을 설계의 표면으로 끌어올리기는 하지만

여전히 데이터와 기능을 분리하는 절차적인 설계의 틀에 갇혀 있는 것이다

## 클래스

### 클래스는 추상 데이터 타입인가?

대부분의 프로그래밍 서적은 클래스를 추상 데이터 타입으로 설명한다.

클래스와 추상 데이터 타입 모두 데이터 추상화를 기반으로 시스템을 분해하기 때문에 이런 설명이 꼭 틀린 것만은 아니다.

두 메커니즘 모두 외부에서는 객체의 내부 속성에 직접 접근할 수 없으며 오직 퍼블릭 인터페이스를 통해서만 외부와 의사소통할 수 있다.

그러나 명확한 의미에서 추상 데이터 타입과 클래스는 동일하지 않다.

가장 핵심적인 차이는 클래스 상속과 다형성을 지원하는 데 비해 추상 데이터 타입은 지원하지 못한다는 점이다.

<br />

상속과 다형성을 지원하는 객체지향 프로그래밍(Object-Oriented Programming)과 구분하기 위해

상속과 다형성을 지원하지 않는 추상 데이터 타입 기반의 프로그래밍 패러다임을 객체기반 프로그래밍(Object-Based Programming)이라고 부르기도 한다.

<br />

추상 데이터 타입은 타입을 추상화한 것(type abstraction)이고 클래스는 절차를 추상화한 것(procedural abstraction)이다

> 실제로 내부에서 수행되는 절차는 다르지만 클래스를 이용한 다형성은 절차에 대한 차이점을 감춘다. 다시 말해 객체지향은 절차 추상화다

## 변경을 기준으로 선택하라

- 클래스가 추상 데이터 타입의 개념을 따르는지를 확인할 수 있는 가장 간단한 방법은 클래스 내부에 인스턴스의 타입을 표현하는 변수가 있는지를 살펴보는 것이다

- 객체지향에서는 타입 변수를 이용한 조건문을 다형성으로 대체한다

  - 마틴 파울러는 타입을 나타내는 코드를 다형성으로 바꾸는 리팩터링을 "Replace type code with class"라고 부른다

- 기존 코드에 아무런 영향도 미치지 않고 새로운 객체 유형과 행위를 추가할 수 있는 객체지향의 특성을 개방-폐쇄 원칙(Open-Closed Principle, OCP)이라고 부른다. 이것이 객체지향 설계가 전통적인 방식에 비해 변경하고 확장하기 쉬운 구조를 설계할 수 있는 이유다.

설계는 변경과 관련된 것이다. 설계의 유용성은 변경의 방향성과 발생 빈도에 따라 결정된다.

<br />

새로운 타입을 빈번하게 추가해야 한다면 객체지향의 클래스 구조가 더 유용하다.

새로운 오퍼레이션을 빈번하게 추가해야 한다면 추상 데이터 타입을 선택하는 것이 현명한 판단이다.

변경의 축을 찾아라. 객체지향적인 접근법이 모든 경우에 올바른 해결 방법인 것은 아니다.

## 협력이 중요하다

객체지향에서 중요한 것은 역할, 책임, 협력이다.

객체지향은 기능을 수행하기 위해 객체들이 협력하는 방식에 집중한다.

협력이라는 문맥을 고려하지 않고 객체를 고립시킨 채 오퍼레이션의 구현 방식을 타입별로 분배하는 것은 올바른 접근법이 아니다.

<br />

타입 계층과 다형성은 협력이라는 문맥 안에서 책임을 수행하는 방법에 관해 고민한 결과물이어야 하며 그 자체가 목적이 되어서는 안 된다.
